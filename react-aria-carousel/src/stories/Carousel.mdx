import { ArgTypes, Canvas, Controls, Meta, Story } from "@storybook/blocks";

import * as Stories from "./Carousel.stories.tsx";

<Meta title="Usage" />

# Usage

## Installation

```sh
npm install the-thing
```

## API

<ArgTypes of={Stories} exclude={["aspectRatio"]} />

## Example

The example displays a basic carousel of items.

```tsx
import {
  useCarousel,
  useCarouselItem,
  useCarouselNavItem,
  type CarouselAria,
  type CarouselItemOptions,
  type CarouselNavItemOptions,
  type CarouselOptions,
} from "use-carousel";

const styles = {
  root: {
    display: "flex",
    justifyContent: "center",
    flexDirection: "column",
    gap: "16px",
  },
  scroller: {
    display: "grid",
    overflow: "auto",
    scrollSnapType: "x mandatory",
    gridAutoFlow: "column",
    scrollbarWidth: "none",
  },
  buttons: {
    display: "flex",
    justifyContent: "center",
    gap: "8px",
  },
  nav: {
    display: "flex",
    justifyContent: "center",
    alignItems: "start",
    gap: "16px",
  },
  item: {
    background: "rgb(186, 230, 253)",
    aspectRatio: "16 / 9",
    display: "flex",
    justifyContent: "center",
    alignItems: "center",
  },
};

export const Carousel = <T extends object>(props: CarouselOptions<T>) => {
  const [assignRef, carousel] = useCarousel({
    spaceBetweenSlides: "16px",
    itemsPerPage: 2,
    ...props,
  });

  const {
    rootProps,
    prevButtonProps,
    nextButtonProps,
    scrollerProps,
    navProps,
    collection,
  } = carousel;

  return (
    <div {...rootProps} style={styles.root}>
      <div style={styles.buttons}>
        <button {...prevButtonProps}>Previous</button>
        <button {...nextButtonProps}>Next</button>
      </div>
      <div
        {...scrollerProps}
        ref={assignRef}
        style={{
          ...styles.scroller,
          ...scrollerProps.style,
        }}
      >
        {[...collection].map((item) => (
          <CarouselItem state={carousel} item={item} key={item.key} />
        ))}
      </div>
      <div {...navProps} style={styles.nav}>
        {carousel.pages.map((_, i) => (
          <CarouselNavItem key={i} index={i} state={carousel} />
        ))}
      </div>
    </div>
  );
};

export function CarouselItem<T extends object>(
  props: CarouselItemOptions<T> & { state: CarouselAria<T> },
) {
  const { item, state } = props;
  const { itemProps } = useCarouselItem(props, state);

  return (
    <div {...itemProps} style={styles.item}>
      {item.rendered}
    </div>
  );
}

export function CarouselNavItem<T extends object>(
  props: CarouselNavItemOptions & { state: CarouselAria<T> },
) {
  const { index, state } = props;
  const { navItemProps, isSelected } = useCarouselNavItem({ index }, state);
  return (
    <button
      type="button"
      {...navItemProps}
      style={{
        backgroundColor: isSelected ? "darkgray" : undefined,
      }}
    >
      {index + 1}
    </button>
  );
}

<Carousel>
  <Item>1</Item>
  <Item>2</Item>
  <Item>3</Item>
  <Item>4</Item>
  <Item>5</Item>
  <Item>6</Item>
</Carousel>;
```

<Canvas of={Stories.BasicExample} />

## Accessibility & Labeling

## Usage

### Multiple Items per Page

<Canvas of={Stories.MultipleItems} />

### Adding and Removing Items

The carousel will update if items are added or removed.

<Canvas of={Stories.AddingAndRemoving} />

### Autoplay

<Canvas of={Stories.Autoplay} />

### Looping

<Canvas of={Stories.InfiniteLoop} />
<Canvas of={Stories.NativeLoop} />

### Scroll Hint

<Canvas of={Stories.Hint} />

### Mouse Dragging

<Canvas of={Stories.MouseDragging} />

### Dynamic Items

### Orientation

<Canvas of={Stories.Vertical} />
